{
  "hash": "c1a1a4a43792d25e8dae5fc80017e8a3",
  "result": {
    "markdown": "---\ntitle: \"Juvenile snowshoe hares exploration\"\ndescription: |\n  Snowshoe hare data exploration and linear regression in Bonanza Creek Experimental Forest: 1999-Present.\nauthor:\n  - name: Elmera Azadpour\ndate: 2021-09-18\nformat: html\ncategories: [code, analysis, linear model]\n---\n\n\n### To access data, html and Rmd/qmd files:\n-   the snowshoe hares data can be found in the *data* folder of [this repo](https://github.com/elmeraa/assignment4_ESM206); the Rmd and html files can be found in the *src* folder\n-   the qmd format can be found [here](https://github.com/elmeraa/elmeraa.github.io/tree/main/posts/2021-09-18-juvenile-snowshoe-hares-exploration)\n\n\n### Load Packages\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(here)\nlibrary(lubridate)\nlibrary(chron)\nlibrary(kableExtra)\nlibrary(effsize)\nlibrary(ggpubr)\nlibrary(broom)\nlibrary(knitr)\nlibrary(tidytuesdayR)\n```\n:::\n\n\n### Read in data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhares <- read_csv(here(\"posts\", \"2021-09-18-juvenile-snowshoe-hares-exploration\",\"bonanza_hares.csv\")) #read in data \n```\n:::\n\n\n![**Figure 1**: Map of Bonza Creek Experimental Forest, interior Alaska USA (https://www.lter.uaf.edu/research/study-sites-overview)](bonzacreekmap.png)\n\n### Introduction:\n\nThis mini exploratory report is on juvenile snowshoe hares in Bonanza Creek Experimental Forest (Long Term Ecological Research site). The Bonanza Creek LTER is a member of the U.S. LTER Network which is supported by the National Science Foundation and by the USDA Forest Service, Pacific Northwest Research Station. The Bonanza Creek Experimental Forest (BCEF) was established in 1963 is a 50 km^2^ experimental forest located approximately 20 km southwest of Fairbanks, Alaska and located on land owned by the State of Alaska. The Forest is within the Tanana Valley State Forest, a unit managed by the Division of Forestry, State of Alaska. This report covers analyses including: annual juvenile hare trap counts, comparison of juvenile hare weights by sex and site, juvenile weight comparison between male & female snowshoe hares, and an analysis of the relationship between juvenile snowshoe hare hind foot length. (information regarding teh Bonaza Creek LTER network was provided from https://www.lter.uaf.edu/research/study-sites-bcef)\n\n### Data and analyses:\n\nThis analysis contains data with counts and sizes of juvenile snowshoe hares recorded from 1998 - 2012. This report analyses: differences in annual juvenile hare trap counts (Fig. 2), comparison of juvenile hare weights by sex and site (Fig 3), comparison of mean weights for juvenile male and female snowshoe hares (Table 1), comparison of the relationship between juvenile weight & hind foot length (Fig. 4), and a linear regression describing how juvenile snowshoe hare weight changes with respect to hind foot length (Fig. 5). Following exploratory data visualization, weight between male and female hares are by two-sample t-tests using a significance level (α) of 0.05 throughout. Differences between groups are described by Cohen's d effect size. The relationship between hind foot length (mm) and weight (g) is explored by simple linear regression (Fig. 5). All analyses are in R version 4.0.2 using RStudio version 1.3.1056.\n\n## 1. Exploratory findings\n\n### Annual juvenile hare trap counts\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## from the original hares df, mutate to make new columns of the date and then years\n## filter by juveniles \n## group by year\n## report those counts of juveniles by year \nhares_juvinile <- hares %>%   \n  mutate(Date = mdy(date))%>% \n  mutate(Year = year(Date)) %>% \n  filter(age == \"j\") %>% \n  group_by(Year) %>% \n  count()\n\n\n## make a simple line graph of year vs count of the juvenile hare trap counts\nggplot(data = hares_juvinile,\n       aes(x=Year, y= n)) + \n  geom_line(col= \"red\")  +\n  geom_point(col = \"red\") +\n  theme_minimal() +\n  labs(x= \"Year\", \n       y='Count of hare trappings') +\n  scale_x_continuous(breaks=seq(1999, 2012, 2)) \n```\n\n::: {.cell-output-display}\n![**Figure 2.** Annual juvenile hare trap counts (1999 - 2012)](juvenile-snowshoe-hares-exploration_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# mean(hares_juvinile$n)  #to see the mean of counts from the  hares_juvinile df\n# median(hares_juvinile$n) #to see the median of counts from the  hares_juvinile df\n```\n:::\n\n\n#### Major takeaways from Figure 2:\n\nThe max count of juvenile hare trappings was 126 in 1999. The min count of 2 juvenile hare trappings in 2010. The mean annual number of juvenile hares trapped was 31.5. The median annual number of juvenile hares trapped is 18.5. More generally, in more recent years (2005-2012), hare trapping have fluctuated quite a bit showing sharp increases followed by decreases.\n\n## 2. Visualization of juvenile hare weights.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhares_weight <- hares %>% \n  filter(age == \"j\") %>% \n  select(c(\"grid\", \"sex\", \"weight\")) \n\nhares_weight$grid <- as.factor(hares_weight$grid)\ngrid.labs <- c(\"Bonbs\", \"Bonmat\", \"Bonrip\")\nnames(grid.labs) <- c(\"bonbs\", \"bonmat\", \"bonrip\")\n\nggplot(hares_weight, \n       aes(x=sex, y= weight)) +\n  geom_boxplot(aes(fill=sex)) +\n  facet_wrap(~grid, labeller = labeller(grid = grid.labs)) + \n  theme_minimal() +\n  labs(x= \"Sex\", \n       y='Weight (g)') +\n  scale_x_discrete(labels= c(\"Female\", \"Male\", \"NA\")) + \n  scale_y_continuous(breaks=seq(0, 1700, 300)) +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![**Figure 3**. Mean weight observations (g) for juvenile snowhoe hare weights of the three differnt sites (Bonbs, Bonmat, and Bonrip) from 1999 to 2012. With regards to color: pink (female), blue (male) and grey (NA). Box endpoints indicate the 25th and 75th percentile values; the black line indicate the median value for each sex.](juvenile-snowshoe-hares-exploration_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n#### Major takeaways from Figure 3\n\nThis graph depicts juvenile hare weight by sex across the three sites. Site bonbs has the max weight for both male and female hares. In contrast, site bonrip has the lowest weight of female and male hares. Additionally, this graph depicts the upper and lower quartiles of each sex at the different sites. This graph also includes NA values.\n\n## 3. Juvenile weight comparison of male & female snowshoe hares\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhares_weight_mf <- hares %>% \n  filter(age == \"j\") %>% \n  select(c(\"sex\", \"weight\")) %>% \n  group_by(sex) %>% \n  summarise(mean_weight = mean(weight, na.rm=T),\n            sd_weight = sd(weight, na.rm=T),\n            n = n())\n\nhares_weight_mf %>%  \n  kable(col.names = c(\"Sex\",\n                      \"Mean weight (g)\",\n                      \"Standard deviation\",\n                      \"Sample size (n)\"), \n        caption = \"**Table 1**: summary statistics of juvenile male and female snowshoe hare 1999 - 2012\") %>% \n  kable_styling(full_width = FALSE) \n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>**Table 1**: summary statistics of juvenile male and female snowshoe hare 1999 - 2012</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Sex </th>\n   <th style=\"text-align:right;\"> Mean weight (g) </th>\n   <th style=\"text-align:right;\"> Standard deviation </th>\n   <th style=\"text-align:right;\"> Sample size (n) </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> f </td>\n   <td style=\"text-align:right;\"> 855.3909 </td>\n   <td style=\"text-align:right;\"> 292.2526 </td>\n   <td style=\"text-align:right;\"> 200 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> m </td>\n   <td style=\"text-align:right;\"> 945.8589 </td>\n   <td style=\"text-align:right;\"> 333.2151 </td>\n   <td style=\"text-align:right;\"> 163 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:right;\"> 614.5455 </td>\n   <td style=\"text-align:right;\"> 357.5853 </td>\n   <td style=\"text-align:right;\"> 15 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Histograms\nggplot(data = hares, aes(x = weight)) +\n  geom_histogram(bins = 15) +\n  facet_wrap(~sex, scales = \"free\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 515 rows containing non-finite values (stat_bin).\n```\n:::\n\n::: {.cell-output-display}\n![](juvenile-snowshoe-hares-exploration_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# QQ Plots\nggplot(data= hares, aes(sample = weight)) +\n  geom_qq() +\n  facet_wrap(~sex)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 515 rows containing non-finite values (stat_qq).\n```\n:::\n\n::: {.cell-output-display}\n![](juvenile-snowshoe-hares-exploration_files/figure-html/unnamed-chunk-5-2.png){width=672}\n:::\n\n```{.r .cell-code}\n# two sample t-test\nhares_weight_f <- hares %>% \n  select(c(\"sex\", \"weight\")) %>% \n  filter(sex == \"f\") %>% \n  pull(weight)\n\nhares_weight_m <- hares %>% \n  select(c(\"sex\", \"weight\")) %>% \n  filter(sex == \"m\") %>% \n  pull(weight)\n\nt.test(hares_weight_f, hares_weight_m)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tWelch Two Sample t-test\n\ndata:  hares_weight_f and hares_weight_m\nt = 0.85568, df = 2428.6, p-value = 0.3923\nalternative hypothesis: true difference in means is not equal to 0\n95 percent confidence interval:\n -14.61684  37.24934\nsample estimates:\nmean of x mean of y \n 1359.448  1348.131 \n```\n:::\n\n```{.r .cell-code}\n# cohens d/ effect size\ncohen.d(hares_weight_f, hares_weight_m, na.rm = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCohen's d\n\nd estimate: 0.03389279 (negligible)\n95 percent confidence interval:\n      lower       upper \n-0.04522614  0.11301172 \n```\n:::\n:::\n\n\n#### Major takeaway from means comparison output:\n\nMale snowshoe juvenile hares had the larger mean (945.8589 ± 333.2151, *n* = 163; mean ± 1 standard deviation), compared to snowshoe female juvenile hares which had a smaller mean (855.3909 ± 292.2526, *n* = 200; mean ± 1 standard deviation). The actual difference in means from juvenile male and female snowshoe hares is 11.317. The outcomes of the two sample t-test indicates there is a pretty decent chance (40%) of randomly selecting two samples from populations with the same mean that are this different by chance. In sum, the difference in means is not significant (Welch's two-sample t-test: t(2428.6) = 0.85568, p \\> 0.001), and the effect size is negligible (Cohen's d = 0.0334).\n\n## 4. Examining relationship between juvenile weight & hind foot length.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhares_hind <- hares %>% \n  filter(age == \"j\") %>% \n  select(c(\"weight\", \"hindft\"))\n\n\nggplot(hares_hind, \n       aes(x=weight, y=hindft)) + \n  geom_point() +\n  theme_minimal() +\n  labs(x= \"Weight (g)\", \n       y='Hind foot length (mm)') + \n  scale_x_continuous(breaks=seq(0, 1800, 400)) \n```\n\n::: {.cell-output-display}\n![**Figure 4.** Juvenile hare weights vs hind foot length from 1999 - 2012](juvenile-snowshoe-hares-exploration_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n## 5. Linear model output\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## linear regression \nhares_lm <- lm(weight ~ hindft, data = hares_hind)\n\n# Return the complete overview:\nsummary(hares_lm)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = weight ~ hindft, data = hares_hind)\n\nResiduals:\n   Min     1Q Median     3Q    Max \n-661.1 -108.2   17.0  164.2  737.5 \n\nCoefficients:\n             Estimate Std. Error t value Pr(>|t|)    \n(Intercept) -279.3419   115.4811  -2.419   0.0163 *  \nhindft         9.5234     0.9283  10.259   <2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 263.9 on 247 degrees of freedom\n  (129 observations deleted due to missingness)\nMultiple R-squared:  0.2988,\tAdjusted R-squared:  0.2959 \nF-statistic: 105.2 on 1 and 247 DF,  p-value: < 2.2e-16\n```\n:::\n\n```{.r .cell-code}\n# We can use the broom::tidy() function to get the model outputs in nice data frame format:\nhares_lm_tidy <- broom::tidy(hares_lm)\n\n# Get the intercept: \nhares_int <- hares_lm_tidy$estimate[1]\nhares_int\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] -279.3419\n```\n:::\n\n```{.r .cell-code}\n# Then to get the flipper_length coefficient:\nhares_coef <- hares_lm_tidy$estimate[2]\nhares_coef\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 9.523399\n```\n:::\n\n```{.r .cell-code}\n#What about getting some other model information (degrees of freedom, F-statistic, p-value, etc.)?\n#Many of these statistical outcomes can be accessed more easily using broom::glance().\n# Metrics at a glance: \nhares_lm_out <- broom::glance(hares_lm)\nhares_lm_out\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 12\n  r.squared adj.r.squa…¹ sigma stati…²  p.value    df logLik   AIC   BIC devia…³\n      <dbl>        <dbl> <dbl>   <dbl>    <dbl> <dbl>  <dbl> <dbl> <dbl>   <dbl>\n1     0.299        0.296  264.    105. 8.46e-21     1 -1741. 3487. 3498.  1.72e7\n# … with 2 more variables: df.residual <int>, nobs <int>, and abbreviated\n#   variable names ¹​adj.r.squared, ²​statistic, ³​deviance\n# ℹ Use `colnames()` to see all variable names\n```\n:::\n\n```{.r .cell-code}\n# Explore model assumptions\nplot(hares_lm)\n```\n\n::: {.cell-output-display}\n![](juvenile-snowshoe-hares-exploration_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](juvenile-snowshoe-hares-exploration_files/figure-html/unnamed-chunk-7-2.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](juvenile-snowshoe-hares-exploration_files/figure-html/unnamed-chunk-7-3.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](juvenile-snowshoe-hares-exploration_files/figure-html/unnamed-chunk-7-4.png){width=672}\n:::\n\n```{.r .cell-code}\n# Pearson’s r\nhares_cor <- cor.test(hares_hind$weight, hares_hind$hindft)\nhares_cor\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tPearson's product-moment correlation\n\ndata:  hares_hind$weight and hares_hind$hindft\nt = 10.259, df = 247, p-value < 2.2e-16\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n 0.4530683 0.6282259\nsample estimates:\n      cor \n0.5465982 \n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Visualize the model\nggplot(data = hares_hind, aes(x = weight, y = hindft)) +\n  geom_point(size = 2) +\n  geom_smooth(method = \"lm\",\n              color = \"red\",\n              size = 0.5,\n              fill = \"gray10\",\n              alpha = 0.5) +\n  theme_light() +\n  ggpubr::stat_regline_equation(label.x = 230, label.y = 160) +\n  labs(x= \"Weight (g)\", \n       y='Hind foot length (mm)')\n```\n\n::: {.cell-output-display}\n![**Figure 5.** Linear model of weight (g) vs hind foot length (mm) in juvenile snowshoe hare (1999 - 2012)](juvenile-snowshoe-hares-exploration_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n#### Outcomes of linear regression:\n\nSimple linear regression was used to explore between juvenile snowshoe hare weight (g) and hare hind foot length (mm) across all sites, and including both male and female snowshoe hares. A significant regression model was found ($\\beta$ = 9.523, F(1,247) = 105.2, p \\< 0.001) with an R^2^ of 0.299. The slope of the linear model is 9.523 and the y-intercept is -279.3. This slope of the linear model suggests that on average, we expect that weight to increase by 9.523 grams for each 1 mm of increase in hind foot length. Additionally, when conducting a linear model, there are assumptions such as, linearly related variables, normally distributed, Homoscedasticity and iid residuals (no serial correlation). When looking at the Residual Variances, for Homoscedasticity, it appears residuals do not appear randomly distributed evenly around the horizontal dotted line. Additionally, in the QQ plot, the residuals do not appear to be entirely normally distributed -- theres quite a few points on the tails that drift from the dotted line. This is probably partly why we see a more moderate R value (0.547).\n\n#### Summary of juvenile hares exploration:\n\n-   The max count of juvenile hare trappings was 126 in 1999. The min count of juvenile hare trappings was 2 in 2010. The mean annual number of juvenile hares trapped was 31.5. The median annual number of juvenile hares trapped is 18.5. More generally, in more recent years (2005-2012), hare trapping have fluctuated quite a bit showing sharp increases followed by decreases.\n-   The actual difference in means from juvenile male and female snowshoe hares is 11.317. The outcomes of the two sample t-test indicates there is a pretty decent chance (40%) of randomly selecting two samples from populations with the same mean that are this different by chance. The cohend d (effect size) is 0.03389279, a negligible effect size.\n-   This slope of the linear model suggests that on average, we expect that weight to increase by 9.523 grams for each 1 mm of increase in juvenile hind foot length.\n-   Obtained a moderate persons *r* = 0.547 value between weights and hind foot length\n\n#### Citations:\n\n-   Kielland, K., F.S. Chapin, R.W. Ruess, and Bonanza Creek LTER. 2017. Snowshoe hare physical data in Bonanza Creek Experimental Forest: 1999-Present ver 22. Environmental Data Initiative. https://doi.org/10.6073/pasta/03dce4856d79b91557d8e6ce2cbcdc14\n\n-   Link to metadata: https://portal.edirepository.org/nis/metadataviewer?packageid=knb-lter-bnz.55.22\n",
    "supporting": [
      "juvenile-snowshoe-hares-exploration_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"../../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}