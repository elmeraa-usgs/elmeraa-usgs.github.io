{"title":"Black-Throated Blue Warblers linear model selection","markdown":{"yaml":{"title":"Black-Throated Blue Warblers linear model selection","description":"Model Selection and Justification of Black-throated Blue Warbler capture histories, Hubbard Brook Experimental Forest, 1986 - 2010  .\n","author":[{"name":"Elmera Azadpour"}],"date":"2021-09-18","format":"html","categories":["code","analysis","linear model"],"image":"warblers.jpg"},"headingText":"To access data, html and Rmd/qmd files:","containsRefs":false,"markdown":"\n\n-   the warblers data can be found in the *exam_data* folder of [this repo]( https://github.com/elmeraa/elmera-azadpour-206-final); the Rmd and html files can be found in the *task_code* folder\n-   the qmd format can be found [here](https://github.com/elmeraa/elmeraa.github.io/tree/main/posts/2021-09-18-black-throated-blue-warblers-visualization)\n\n```{r setup, message = FALSE}\nlibrary(tidyverse)\nlibrary(here)\nlibrary(broom)\nlibrary(car)\nlibrary(GGally)\nlibrary(stargazer)\n```\n\n```{r, message = FALSE}\n## Read in bt_warblers.csv\nwarblers <- read_csv(here(\"posts\", \"2021-09-18-black-throated-blue-warblers-visualization\",\"bt_warblers.csv\"))\n```\n\n## Data exploration and visualization\n\n```{r, echo = FALSE, error = FALSE, warning=FALSE, message=FALSE}\nwarblers_clean <- warblers %>% filter_all(all_vars(.> -98))\n\nwarblers$age_banded <- as.factor(warblers$age_banded)\nage_banded.labs <- c(\"After Second Year\", \"After Hatch Year\", \"Second Year\")\nnames(age_banded.labs) <- c(\"ASY\", \"AHY\", \"SY\")\n\n\n## Wing length versus bird mass, with color indicating sex and faceted by bird age at capture\nggplot(warblers_clean, aes(x = wing_r,\n                     y = mass)) +\n  geom_point(aes(col= sex)) +\n  facet_wrap(~age_banded, labeller = labeller(age_banded = age_banded.labs)) +\n  labs(y = \"Bird mass (g)\", x = \"Right wing length (mm)\") +\n  scale_colour_discrete(name = \"Sex\")\n\n## Bill cross-section depth vs bird mass with color indicating sex and faceted by elevation\nwarblers$elevation <- as.factor(warblers$elevation)\nelevation.labs <- c(\"Low elevation\", \"Mid elevation\", \"High elevation\")\nnames(elevation.labs) <- c(\"low\", \"mid\", \"high\")\n\nggplot(warblers_clean, aes(x = bill_depth,\n                     y = mass)) +\n  geom_point(aes(col= sex)) +\n  facet_wrap(~elevation, labeller = labeller(elevation = elevation.labs)) +\n  labs(x = \"Bill cross-section depth (mm)\", y = \"Bird mass (g)\") +\n  scale_colour_discrete(name = \"Sex\")\n\n\n## Culmen length (i.e. upper bill ridge length) vs Right wing length with color indicating sex and faceted by elevation\nggplot(warblers_clean, aes(x = bill_culmen,\n                     y = wing_r)) +\n  geom_point(aes(col= sex)) +\n  facet_wrap(~elevation, labeller = labeller(elevation = elevation.labs)) +\n  labs(x = \"Culmen length (mm)\", y = \"Right wing length (mm)\") +\n  scale_colour_discrete(name = \"Sex\")\n```\n\n```{r, error=FALSE, warning=FALSE, message=FALSE}\n## Model 1: DV is bird mass, predictor variables are: right wing length (mm), tarsus length (mm), age of bird at capture, and sex. \nwarblers_lm <- lm(mass ~ wing_r + tarsus1 + age_banded + sex, data = warblers_clean)\nsummary(warblers_lm)\nAIC(warblers_lm) # 1202.795\nvif(warblers_lm) \nwarblers_lm \n\nwarblers_lm_tidy <- tidy(warblers_lm)\nwarblers_lm_tidy\n\nwarblers_lm_fit <- glance(warblers_lm)\nwarblers_lm_fit\n\nplot(warblers_lm)\n\n## Model 2: DV is bird mass, predictor variables are:  tarsus length (mm), age of bird at capture, and sex. \nwarblers_lm2 <- lm(mass ~  tarsus1 + age_banded + sex, data = warblers_clean)\nsummary(warblers_lm2)\nAIC(warblers_lm2) # 1222.922\nvif(warblers_lm2)\nplot(warblers_lm2)\nwarblers_lm_fit2 <- glance(warblers_lm2)\n\n## Model 3: DV is bird mass, predictor variables are: age of bird at capture, and sex. \nwarblers_lm3 <- lm(mass ~ age_banded + sex, data = warblers_clean)\nsummary(warblers_lm3)\nAIC(warblers_lm3) # 1226.497\nvif(warblers_lm3)\nplot(warblers_lm3)\nwarblers_lm_fit3 <- glance(warblers_lm3)\n\n# Histograms\nggplot(data = warblers_clean, aes(x = mass)) +\n  geom_histogram(bins = 15) +\n  facet_wrap(~sex, scales = \"free\")\n\n# QQ Plots\nggplot(data= warblers_clean, aes(sample = mass)) +\n  geom_qq() +\n  facet_wrap(~sex)\n```\n\n### Regression table\n\n```{r,  results = \"asis\", error=FALSE}\nstargazer(warblers_lm, type = \"html\")\n```\n\n### Model Selection and Justification\n\n**Model 1:** DV is bird mass, predictor variables are: right wing length (mm), tarsus length (mm), age of bird at capture, and sex. (I have selected this one as the final model). *Model 2:* DV is bird mass, predictor variables are: tarsus length (mm), age of bird at capture, and sex. *Model 3:* DV is bird mass, predictor variables are: age of bird at capture, and sex.\n\n-   Warblers data set is normally distributed for mass with respect to sex.\n\n-   When looking at the Residual Variances, for Homoscedasticity, it appears residuals appear more randomly distributed evenly around the horizontal dotted line compared to model 2 and model 3.\n\n-   Residual plots and Q-Q plots visually show that model 1 meets the homoscedasticity and normality assumptions of linear regression.\n\n-   AIC score for model 1 was the lowest (`r round(warblers_lm_fit$AIC, 2)`) compared to model 2 (`r round(warblers_lm_fit2$AIC, 2)`) and 3 (`r round(warblers_lm_fit3$AIC, 2)`).\n\n-   Conceptually, including predictor variables like wing length, tarsus length, age of bird capture and sex indicate a stronger correlation to bird mass (`r round(warblers_lm_fit$adj.r.squared, 2)`). The adjusted R^2^ value here (`r round(warblers_lm_fit$adj.r.squared, 2)`) indicates that `r 100*round(warblers_lm_fit$adj.r.squared, 2)` % of variance in body mass is explained by these variables included in the model.\n\n#### Interpreting given coeffients in Model 1:\n\n-   The slope of the linear model was 0.0739 for right wing length (mm), 0.0743 for tarsus length (mm), -0.052 for age of bird at capture, -1.043 for sex, and the y-intercept was 4.613. This suggests that on average, we expect that bird body mass (g) to increase by 0.0739 grams for each 1 mm of increase in right wing length. We expect bird body mass to increase by 0.0743 grams for each 1 mm of increase in bird tarsus length.\n\n#### Black-throated blue warbler data source:\n\n-   Rodenhouse, N., R. Holmes, S. Sillett, and M. Webster. 2019. Black-throated Blue Warbler capture histories, Hubbard Brook Experimental Forest, 1986 - 2010 ver 4. Environmental Data Initiative. https://doi.org/10.6073/pasta/ea985022acfdb76cd7beeaf8da6c39b1\n"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":true,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-yaml":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../../styles.css"],"output-file":"black-throated-blue-warblers-visualization.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.0.36","editor":"visual","theme":"../../ember.scss","title-block-banner":true,"title":"Black-Throated Blue Warblers linear model selection","description":"Model Selection and Justification of Black-throated Blue Warbler capture histories, Hubbard Brook Experimental Forest, 1986 - 2010  .\n","author":[{"name":"Elmera Azadpour"}],"date":"2021-09-18","categories":["code","analysis","linear model"],"image":"warblers.jpg"},"extensions":{"book":{"multiFile":true}}}}}